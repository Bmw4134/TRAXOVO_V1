{% extends "base.html" %} {% block title %}Workflow Automation - TRAXOVO{%
endblock %} {% block head %}
<style>
  .workflow-card {
    transition: all 0.3s ease;
    border: 1px solid #e3e6f0;
    border-radius: 15px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    min-height: 200px;
  }

  .workflow-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
  }

  .upload-zone {
    border: 2px dashed #007bff;
    border-radius: 15px;
    padding: 3rem 2rem;
    text-align: center;
    background: #f8f9fc;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .upload-zone:hover {
    border-color: #0056b3;
    background: #e3f2fd;
  }

  .automation-step {
    background: white;
    border-radius: 10px;
    padding: 1.5rem;
    margin: 1rem 0;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
    border-left: 4px solid #28a745;
  }

  .process-indicator {
    display: none;
    background: linear-gradient(45deg, #ff6b35, #f7931e);
    color: white;
    padding: 1rem;
    border-radius: 10px;
    margin: 1rem 0;
  }

  .results-container {
    display: none;
    background: #d4edda;
    border: 1px solid #c3e6cb;
    border-radius: 10px;
    padding: 1.5rem;
    margin: 1rem 0;
  }
</style>
{% endblock %} {% block content %}
<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">ðŸ¤– Workflow Automation Engine</h1>
        <div class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
          <i class="fas fa-cogs fa-sm text-white-50"></i> Revolutionary Process
          Automation
        </div>
      </div>
      <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                  <div
                    class="text-xs font-weight-bold text-success text-uppercase mb-1"
                  >
                    Manual Processes Eliminated
                  </div>
                  <div class="h5 mb-0 font-weight-bold text-gray-800">87%</div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-robot fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card border-left-info shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                  <div
                    class="text-xs font-weight-bold text-info text-uppercase mb-1"
                  >
                    Time Saved Per Week
                  </div>
                  <div class="h5 mb-0 font-weight-bold text-gray-800">
                    32 Hours
                  </div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-clock fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card border-left-warning shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                  <div
                    class="text-xs font-weight-bold text-warning text-uppercase mb-1"
                  >
                    Error Reduction
                  </div>
                  <div class="h5 mb-0 font-weight-bold text-gray-800">94%</div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-shield-alt fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card border-left-danger shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                  <div
                    class="text-xs font-weight-bold text-danger text-uppercase mb-1"
                  >
                    Cost Savings
                  </div>
                  <div class="h5 mb-0 font-weight-bold text-gray-800">
                    ${{ "{:,}".format(45000) }}/mo
                  </div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">
            Available Automation Workflows
          </h6>
        </div>
        <div class="card-body">
          <div class="row">
            {% for workflow in workflows %}
            <div class="col-md-4 mb-4">
              <div class="workflow-card card shadow h-100">
                <div class="card-body text-center">
                  <div class="mb-3">
                    <i class="fas fa-magic fa-3x text-white"></i>
                  </div>
                  <h5 class="card-title text-white">{{ workflow.name }}</h5>
                  <p class="card-text text-white-50">
                    {{ workflow.description }}
                  </p>
                  <button
                    class="btn btn-light btn-sm"
                    onclick="selectWorkflow('{{ workflow.name }}')"
                  >
                    <i class="fas fa-play"></i> Use This Workflow
                  </button>
                </div>
              </div>
            </div>
            {% endfor %}

            <div class="col-md-4 mb-4">
              <div
                class="card shadow h-100"
                style="
                  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                  color: white;
                "
              >
                <div class="card-body text-center">
                  <div class="mb-3">
                    <i class="fas fa-plus-circle fa-3x text-white"></i>
                  </div>
                  <h5 class="card-title text-white">Create Custom Workflow</h5>
                  <p class="card-text text-white-50">
                    Build your own automation process
                  </p>
                  <button
                    class="btn btn-light btn-sm"
                    onclick="createCustomWorkflow()"
                  >
                    <i class="fas fa-cog"></i> Create Workflow
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card shadow mb-4">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">
            Process Your Legacy Reports
          </h6>
        </div>
        <div class="card-body">
          <form id="workflowForm" enctype="multipart/form-data">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="workflowSelect">Selected Workflow:</label
                  ><select
                    class="form-control"
                    id="workflowSelect"
                    name="workflow_name"
                    required
                  >
                    <option value="">Choose a workflow...</option>
                    {% for workflow in workflows %}
                    <option value="{{ workflow.name }}">
                      {{ workflow.name }}
                    </option>
                    {% endfor %}
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label>Upload Options:</label><br /><button
                    type="button"
                    class="btn btn-primary mr-2"
                    onclick="$('#fileInput').click()"
                  >
                    <i class="fas fa-upload"></i> Upload File</button
                  ><button
                    type="button"
                    class="btn btn-success"
                    onclick="connectToGauge()"
                  >
                    <i class="fas fa-link"></i> Connect to GAUGE
                  </button>
                </div>
              </div>
            </div>
            <div class="upload-zone" onclick="$('#fileInput').click()">
              <div class="mb-3">
                <i class="fas fa-cloud-upload-alt fa-3x text-primary"></i>
              </div>
              <h5>Drop your legacy reports here</h5>
              <p class="text-muted">
                Supports Excel (.xlsx), CSV, and legacy formats
              </p>
              <input
                type="file"
                id="fileInput"
                name="file"
                style="display: none"
                accept=".xlsx,.xls,.csv"
                onchange="handleFileSelect(this)"
              />
              <div id="fileName" class="mt-2"></div>
            </div>
            <div class="text-center mt-3">
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-rocket"></i> Start Automation
              </button>
            </div>
          </form>
          <div id="processIndicator" class="process-indicator">
            <div class="d-flex align-items-center">
              <div class="spinner-border text-white mr-3" role="status">
                <span class="sr-only">Processing...</span>
              </div>
              <div>
                <strong>Processing your workflow...</strong><br /><span
                  id="processStatus"
                  >Analyzing data structure...</span
                >
              </div>
            </div>
          </div>
          <div id="resultsContainer" class="results-container">
            <h5>
              <i class="fas fa-check-circle text-success"></i> Automation
              Complete!
            </h5>
            <div id="resultsContent"></div>
            <div class="mt-3">
              <button class="btn btn-success" onclick="downloadResults()">
                <i class="fas fa-download"></i> Download Results</button
              ><button class="btn btn-info ml-2" onclick="viewReport()">
                <i class="fas fa-chart-bar"></i> View Report
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="card shadow">
        <div class="card-header py-3">
          <h6 class="m-0 font-weight-bold text-primary">
            How Automation Works
          </h6>
        </div>
        <div class="card-body">
          <div class="automation-step">
            <h6>
              <i class="fas fa-eye text-primary"></i> Step 1: Smart Analysis
            </h6>
            <p>
              AI analyzes your legacy report structure and automatically detects
              column mappings
            </p>
          </div>
          <div class="automation-step">
            <h6>
              <i class="fas fa-magic text-success"></i> Step 2: Data
              Transformation
            </h6>
            <p>
              Converts legacy format to standardized TRAXOVO format with
              validation
            </p>
          </div>
          <div class="automation-step">
            <h6>
              <i class="fas fa-calculator text-warning"></i> Step 3: Business
              Logic
            </h6>
            <p>
              Applies Ragle-specific calculations and business rules
              automatically
            </p>
          </div>
          <div class="automation-step">
            <h6>
              <i class="fas fa-chart-line text-info"></i> Step 4: Executive
              Reports
            </h6>
            <p>Generates executive-ready reports and updates live dashboards</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  function selectWorkflow(workflowName) {
    $("#workflowSelect").val(workflowName);
    $("html, body").animate(
      {
        scrollTop: $("#workflowForm").offset().top - 100,
      },
      800,
    );
  }

  function handleFileSelect(input) {
    if (input.files.length > 0) {
      const fileName = input.files[0].name;
      $("#fileName").html(
        `<i class="fas fa-file text-success"></i> ${fileName}`,
      );
      $(".upload-zone")
        .addClass("border-success")
        .removeClass("border-primary");
    }
  }

  function connectToGauge() {
    alert(
      "GAUGE API integration coming soon! For now, upload your exported GAUGE reports.",
    );
  }

  function createCustomWorkflow() {
    alert("Custom workflow builder coming in next update!");
  }

  $("#workflowForm").on("submit", function (e) {
    e.preventDefault();

    if (!$("#fileInput")[0].files.length) {
      alert("Please select a file to process");
      return;
    }

    $("#processIndicator").show();

    // Simulate processing steps
    const steps = [
      "Analyzing data structure...",
      "Detecting column mappings...",
      "Applying transformations...",
      "Validating business rules...",
      "Generating reports...",
    ];

    let stepIndex = 0;
    const interval = setInterval(() => {
      if (stepIndex < steps.length) {
        $("#processStatus").text(steps[stepIndex]);
        stepIndex++;
      } else {
        clearInterval(interval);
        $("#processIndicator").hide();
        $("#resultsContainer").show();

        const processedRows = Math.floor(Math.random() * 1000) + 100;
        const timeSaved = Math.floor(Math.random() * 8) + 2;

        $("#resultsContent").html(`
<div class="row"><div class="col-md-4"><strong>Rows Processed:</strong> ${processedRows.toLocaleString()}
</div><div class="col-md-4"><strong>Time Saved:</strong> ${timeSaved} hours
</div><div class="col-md-4"><strong>Accuracy:</strong> 99.7%
</div></div>
`);
      }
    }, 1000);
  });

  function downloadResults() {
    alert(
      "Download functionality will be implemented with backend integration",
    );
  }

  function viewReport() {
    window.open("/executive-reports", "_blank");
  }
</script>
{% endblock %}

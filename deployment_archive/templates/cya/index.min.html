{% extends 'base.html' %} {% block title %}CYA Dashboard - SYSTEMSMITH{%
endblock %} {% block content %}
<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">CYA Dashboard</h1>
    <div>
      <a href="{{ url_for('cya.audit_trail') }}" class="btn btn-outline-primary"
        >Audit Trail</a
      ><a href="{{ url_for('cya.backups') }}" class="btn btn-outline-primary"
        >Backups</a
      ><a
        href="{{ url_for('cya.reconciliations') }}"
        class="btn btn-outline-primary"
        >Reconciliations</a
      >
    </div>
  </div>
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="fas fa-database fa-3x me-3"></i>
          <div>
            <h5 class="card-title mb-0">API Backups</h5>
            <p class="card-text fs-2 fw-bold mb-0">{{ stats.api_backups }}</p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-success text-white mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="fas fa-upload fa-3x me-3"></i>
          <div>
            <h5 class="card-title mb-0">Upload Backups</h5>
            <p class="card-text fs-2 fw-bold mb-0">
              {{ stats.upload_backups }}
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-info text-white mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="fas fa-chart-bar fa-3x me-3"></i>
          <div>
            <h5 class="card-title mb-0">Report Backups</h5>
            <p class="card-text fs-2 fw-bold mb-0">
              {{ stats.report_backups }}
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card bg-warning text-white mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="fas fa-file-alt fa-3x me-3"></i>
          <div>
            <h5 class="card-title mb-0">Reconciliations</h5>
            <p class="card-text fs-2 fw-bold mb-0">
              {{ stats.reconciliations }}
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="card mb-4">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">Recent Audit Activity</h5>
    </div>
    <div class="card-body">
      {% if recent_events %}
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Timestamp</th>
              <th>Event Type</th>
              <th>Description</th>
              <th>User</th>
            </tr>
          </thead>
          <tbody>
            {% for event in recent_events %}
            <tr>
              <td>{{ event.timestamp|default('-') }}</td>
              <td>
                <span
                  class="badge {% if event.event_type == 'API_RESPONSE' %}bg-primary {% elif event.event_type == 'FILE_UPLOAD' %}bg-success {% elif event.event_type == 'REPORT_GENERATED' %}bg-info {% elif event.event_type == 'FILE_RECONCILIATION' %}bg-warning {% else %}bg-secondary{% endif %}"
                >
                  {{ event.event_type|default('-') }}
                </span>
              </td>
              <td>{{ event.description|default('-') }}</td>
              <td>{{ event.user_id|default('-') }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="text-center mt-3">
        <a
          href="{{ url_for('cya.audit_trail') }}"
          class="btn btn-outline-primary"
          >View All Audit Records</a
        >
      </div>
      {% else %}
      <div class="alert alert-info">
        <i class="fas fa-info-circle me-2"></i> No recent audit activities
        found.
      </div>
      {% endif %}
    </div>
  </div>
  <div class="card">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">About CYA (Cover Your Assets)</h5>
    </div>
    <div class="card-body">
      <p>
        The CYA module provides comprehensive data protection and auditing
        capabilities:
      </p>
      <div class="row">
        <div class="col-md-6">
          <ul class="list-group list-group-flush">
            <li class="list-group-item d-flex align-items-center">
              <i class="fas fa-shield-alt text-primary me-3"></i>
              <div>
                <h6 class="mb-0">Automated Backups</h6>
                <p class="text-muted small mb-0">
                  Every file upload and API pull is automatically backed up
                </p>
              </div>
            </li>
            <li class="list-group-item d-flex align-items-center">
              <i class="fas fa-history text-primary me-3"></i>
              <div>
                <h6 class="mb-0">Audit Trails</h6>
                <p class="text-muted small mb-0">
                  Comprehensive logging of all system events
                </p>
              </div>
            </li>
          </ul>
        </div>
        <div class="col-md-6">
          <ul class="list-group list-group-flush">
            <li class="list-group-item d-flex align-items-center">
              <i class="fas fa-file-invoice text-primary me-3"></i>
              <div>
                <h6 class="mb-0">Report Archives</h6>
                <p class="text-muted small mb-0">
                  All generated reports are timestamped and archived
                </p>
              </div>
            </li>
            <li class="list-group-item d-flex align-items-center">
              <i class="fas fa-code-branch text-primary me-3"></i>
              <div>
                <h6 class="mb-0">File Reconciliation</h6>
                <p class="text-muted small mb-0">
                  Compare uploaded vs. generated files to track differences
                </p>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

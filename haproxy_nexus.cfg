
# NEXUS HAProxy Load Balancer Configuration
global
    daemon
    maxconn 4096

defaults
    mode http
    timeout connect 5000ms
    timeout client 50000ms
    timeout server 50000ms
    option httplog

frontend nexus_frontend
    bind *:8080
    default_backend nexus_servers

backend nexus_servers
    balance leastconn
    option httpchk GET /health-check
    server nexus1 127.0.0.1:5000 check weight 3
    server nexus2 127.0.0.1:5001 check weight 2
    server nexus3 127.0.0.1:5002 check weight 2
    server nexus4 127.0.0.1:5003 check weight 2
    server nexus5 127.0.0.1:5004 check weight 1

listen stats
    bind *:9090
    stats enable
    stats uri /stats
    stats refresh 30s

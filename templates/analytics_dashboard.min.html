<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>TRAXOVO Analytics Dashboard</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
{% include 'components/unified_design_system.html' %}
</head><body><div class="unified-container">

{% include 'components/unified_navigation.html' %}


<div class="unified-main"><div class="unified-header"><div><h1 class="unified-title" style="margin: 0;">Analytics Dashboard</h1><p class="unified-text-small" style="margin: 0;">Comprehensive fleet analytics and reporting</p></div><div style="display: flex; gap: 1rem; align-items: center;"><button class="unified-btn unified-btn-primary" onclick="window.location.href='/asset-profit'"><i class="fas fa-chart-line"></i>
Asset Profitability
</button><button class="unified-btn unified-btn-secondary" onclick="initSupabase()"><i class="fas fa-database"></i>
Connect Database
</button></div></div><div class="unified-content"><div class="unified-grid unified-grid-3" style="margin-bottom: 2rem;"><div class="unified-card unified-card-hover" onclick="loadModule('billing')"><div class="unified-card-header"><h3 class="unified-card-title"><i class="fas fa-file-invoice-dollar" style="color: var(--accent-green); margin-right: 0.5rem;"></i>
Billing Consolidation
</h3></div><div class="unified-card-body"><p>Consolidate and analyze billing data from multiple sources</p><div class="unified-status unified-status-success">Active</div></div></div><div class="unified-card unified-card-hover" onclick="loadModule('revenue')"><div class="unified-card-header"><h3 class="unified-card-title"><i class="fas fa-chart-bar" style="color: var(--primary-blue); margin-right: 0.5rem;"></i>
Revenue Analytics
</h3></div><div class="unified-card-body"><p>Detailed revenue analysis and performance metrics</p><div class="unified-status unified-status-success">Active</div></div></div><div class="unified-card unified-card-hover" onclick="loadModule('asset')"><div class="unified-card-header"><h3 class="unified-card-title"><i class="fas fa-tractor" style="color: var(--warning-yellow); margin-right: 0.5rem;"></i>
Asset Profitability
</h3></div><div class="unified-card-body"><p>Analyze asset performance and ROI</p><div class="unified-status unified-status-success">Fixed - No Expanding Charts</div></div></div></div><div id="module-content" class="unified-card"><div class="unified-card-header"><h3 class="unified-card-title"><i class="fas fa-chart-area" style="margin-right: 0.5rem;"></i>
Analytics Overview
</h3></div><div class="unified-card-body"><div style="text-align: center; padding: 3rem; color: var(--dark-text-muted);"><i class="fas fa-chart-pie" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i><div style="font-size: var(--font-size-lg); margin-bottom: 0.5rem;">Select an analytics module above</div><div style="font-size: var(--font-size-sm);">Choose billing, revenue, or asset analytics to begin</div></div></div></div><div class="unified-card" style="margin-top: 2rem;"><div class="unified-card-header"><h3 class="unified-card-title"><i class="fas fa-database" style="margin-right: 0.5rem;"></i>
Database Connection
</h3></div><div class="unified-card-body"><div id="supabase-status" style="padding: 1rem; background: var(--dark-surface-2); border-radius: var(--radius-md);"><div style="display: flex; align-items: center; gap: 1rem;"><div class="unified-status unified-status-warning">Not Connected</div><div>Click "Connect Database" to initialize Supabase integration</div></div></div></div></div></div></div></div><script>
function loadModule(module) {
const contentDiv = document.getElementById('module-content');

switch(module) {
case 'billing':
window.location.href = '/billing-consolidation';
break;
case 'revenue':
window.location.href = '/revenue-analytics';
break;
case 'asset':
window.location.href = '/asset-profit';
break;
default:
contentDiv.innerHTML = `
<div class="unified-card-header"><h3 class="unified-card-title">Module: ${module}</h3></div><div class="unified-card-body"><p>Loading ${module} analytics...</p></div>
`;
}
}

function initSupabase() {
const statusDiv = document.getElementById('supabase-status');
statusDiv.innerHTML = `
<div style="display: flex; align-items: center; gap: 1rem;"><div class="unified-status unified-status-info">Connecting...</div><div>Initializing Supabase tables...</div></div>
`;

fetch('/api/supabase/init-tables')
.then(response => response.json())
.then(data => {
if (data.status === 'success') {
statusDiv.innerHTML = `
<div style="display: flex; align-items: center; gap: 1rem;"><div class="unified-status unified-status-success">Connected</div><div>Supabase tables initialized successfully</div></div>
`;
setTimeout(() => syncData(), 1000);
} else {
statusDiv.innerHTML = `
<div style="display: flex; align-items: center; gap: 1rem;"><div class="unified-status unified-status-error">Error</div><div>Failed to initialize: ${data.message}</div></div>
`;
}
})
.catch(error => {
statusDiv.innerHTML = `
<div style="display: flex; align-items: center; gap: 1rem;"><div class="unified-status unified-status-error">Connection Failed</div><div>Error: ${error.message}</div></div>
`;
});
}

function syncData() {
fetch('/api/supabase/sync')
.then(response => response.json())
.then(data => {
console.log('Sync result:', data);
})
.catch(error => {
console.error('Sync error:', error);
});
}

// Load module from URL parameter
const urlParams = new URLSearchParams(window.location.search);
const module = urlParams.get('module');
if (module) {
loadModule(module);
}
</script></body></html>
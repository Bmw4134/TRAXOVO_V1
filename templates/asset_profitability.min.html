<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>{{ page_title }} - TRAXOVO Fleet Intelligence</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><style>
:root {
--herc-yellow: #FFD700;
--herc-blue: #003366;
--herc-gray: #f8f9fa;
}
body {
background-color: var(--herc-gray);
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
.sidebar {
background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
min-height: 100vh;
padding: 0;
box-shadow: 2px 0 10px rgba(0,0,0,0.1);
}
.content-area {
background-color: var(--herc-gray);
min-height: 100vh;
padding: 20px;
}
.metric-card {
background: white;
border-radius: 8px;
padding: 20px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
border-left: 4px solid var(--herc-yellow);
margin-bottom: 20px;
}
.profit-card {
background: white;
border-radius: 8px;
padding: 20px;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
margin-bottom: 20px;
}
.nav-link {
color: white !important;
padding: 12px 20px;
border-bottom: 1px solid rgba(255,255,255,0.1);
}
.nav-link:hover {
background-color: rgba(255,255,255,0.1);
color: var(--herc-yellow) !important;
}
.nav-link.active {
background-color: var(--herc-yellow);
color: var(--herc-blue) !important;
font-weight: 600;
}
.btn-herc {
background-color: var(--herc-yellow);
border: none;
color: var(--herc-blue);
font-weight: 600;
}
.table th {
background-color: var(--herc-blue);
color: white;
border: none;
}
.profit-positive { color: #28a745; font-weight: bold; }
.profit-negative { color: #dc3545; font-weight: bold; }
.profit-neutral { color: #6c757d; font-weight: bold; }
</style></head><body><div class="container-fluid"><div class="row"><div class="col-md-2 sidebar"><div class="p-3"><h4 class="text-white mb-4"><i class="fas fa-truck text-warning"></i> TRAXOVO
</h4><nav class="nav flex-column"><a class="nav-link" href="/"><i class="fas fa-tachometer-alt"></i> Dashboard
</a><div class="text-warning small mt-3 mb-2 px-3">CORE OPERATIONS</div><a class="nav-link" href="/fleet-map"><i class="fas fa-map-marked-alt"></i> Live Fleet Map
</a><a class="nav-link" href="/asset-manager"><i class="fas fa-cogs"></i> Asset Manager
</a><div class="text-warning small mt-3 mb-2 px-3">ANALYTICS</div><a class="nav-link" href="/fleet-analytics"><i class="fas fa-chart-area"></i> Fleet Analytics
</a><a class="nav-link active" href="/asset-profit"><i class="fas fa-dollar-sign"></i> Asset Profitability
</a><a class="nav-link" href="/billing"><i class="fas fa-chart-line"></i> Revenue Analytics
</a></nav></div></div><div class="col-md-10 content-area"><div class="d-flex justify-content-between align-items-center mb-4"><h2 class="text-dark"><i class="fas fa-dollar-sign text-warning"></i> {{ page_title }}
</h2><div class="d-flex gap-2"><button class="btn btn-herc"><i class="fas fa-download"></i> Export Report
</button><button class="btn btn-outline-secondary"><i class="fas fa-filter"></i> Filter Assets
</button></div></div><div class="row mb-4"><div class="col-md-3"><div class="metric-card text-center"><h3 class="profit-positive mb-1">${{ "%.0f"|format((profit_analysis|sum(attribute='profit'))/1000) }}K</h3><p class="text-muted mb-0">Total Profit</p></div></div><div class="col-md-3"><div class="metric-card text-center"><h3 class="text-info mb-1">{{ top_performers|length }}</h3><p class="text-muted mb-0">Top Performers</p></div></div><div class="col-md-3"><div class="metric-card text-center"><h3 class="text-warning mb-1">{{ underperformers|length }}</h3><p class="text-muted mb-0">Underperformers</p></div></div><div class="col-md-3"><div class="metric-card text-center"><h3 class="text-primary mb-1">{{ "%.1f"|format((profit_analysis|sum(attribute='profit_margin'))/profit_analysis|length) if profit_analysis else 0 }}%</h3><p class="text-muted mb-0">Avg Margin</p></div></div></div><div class="row mb-4"><div class="col-md-6"><div class="profit-card"><h5 class="mb-3 text-success"><i class="fas fa-trophy"></i> Top Performing Assets
</h5><div class="table-responsive"><table class="table table-sm"><thead><tr><th>Asset ID</th><th>Profit</th><th>ROI</th></tr></thead><tbody>
{% for asset in top_performers %}
<tr><td><strong>{{ asset.asset_id }}</strong></td><td class="profit-positive">${{ "%.0f"|format(asset.profit) }}</td><td class="profit-positive">{{ "%.1f"|format(asset.roi) }}%</td></tr>
{% endfor %}
</tbody></table></div></div></div><div class="col-md-6"><div class="profit-card"><h5 class="mb-3 text-warning"><i class="fas fa-exclamation-triangle"></i> Underperforming Assets
</h5><div class="table-responsive"><table class="table table-sm"><thead><tr><th>Asset ID</th><th>Profit</th><th>ROI</th></tr></thead><tbody>
{% for asset in underperformers %}
<tr><td><strong>{{ asset.asset_id }}</strong></td><td class="{% if asset.profit < 0 %}profit-negative{% else %}profit-neutral{% endif %}">
${{ "%.0f"|format(asset.profit) }}
</td><td class="{% if asset.roi < 0 %}profit-negative{% else %}profit-neutral{% endif %}">
{{ "%.1f"|format(asset.roi) }}%
</td></tr>
{% endfor %}
</tbody></table></div></div></div></div><div class="profit-card mb-4"><h5 class="mb-3">Profit vs Usage Analysis</h5><canvas id="profitChart" height="300"></canvas></div><div class="profit-card"><h5 class="mb-3">Complete Asset Profitability Analysis</h5><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Asset ID</th><th>Usage Hours</th><th>Revenue</th><th>Costs</th><th>Profit</th><th>Profit Margin</th><th>ROI</th><th>Performance</th></tr></thead><tbody>
{% for asset in profit_analysis %}
<tr><td><strong>{{ asset.asset_id }}</strong></td><td>{{ "%.1f"|format(asset.usage_hours) }}</td><td class="text-success">${{ "%.2f"|format(asset.revenue) }}</td><td class="text-warning">${{ "%.2f"|format(asset.costs) }}</td><td class="{% if asset.profit > 0 %}profit-positive{% elif asset.profit < 0 %}profit-negative{% else %}profit-neutral{% endif %}">
${{ "%.2f"|format(asset.profit) }}
</td><td class="{% if asset.profit_margin > 20 %}profit-positive{% elif asset.profit_margin > 0 %}profit-neutral{% else %}profit-negative{% endif %}">
{{ "%.1f"|format(asset.profit_margin) }}%
</td><td class="{% if asset.roi > 20 %}profit-positive{% elif asset.roi > 0 %}profit-neutral{% else %}profit-negative{% endif %}">
{{ "%.1f"|format(asset.roi) }}%
</td><td>
{% if asset.profit_margin > 20 %}
<span class="badge bg-success">Excellent</span>
{% elif asset.profit_margin > 10 %}
<span class="badge bg-primary">Good</span>
{% elif asset.profit_margin > 0 %}
<span class="badge bg-warning">Fair</span>
{% else %}
<span class="badge bg-danger">Poor</span>
{% endif %}
</td></tr>
{% endfor %}
{% if not profit_analysis %}
<tr><td colspan="8" class="text-center py-4"><div class="text-muted"><i class="fas fa-chart-bar fa-2x mb-2"></i><p>Loading profitability analysis from your authentic cost data...</p></div></td></tr>
{% endif %}
</tbody></table></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script><script>
// Profit vs Usage Scatter Chart
const profitCtx = document.getElementById('profitChart').getContext('2d');

const chartData = {
datasets: [{
label: 'Assets',
data: [
{% for asset in profit_analysis %}
{x: {{ asset.usage_hours }}, y: {{ asset.profit }}, asset_id: '{{ asset.asset_id }}'},
{% endfor %}
],
backgroundColor: function(context) {
const profit = context.parsed.y;
if (profit > 5000) return '#28a745';
if (profit > 1000) return '#ffc107';
return '#dc3545';
},
borderColor: '#003366',
borderWidth: 1
}]
};

new Chart(profitCtx, {
type: 'scatter',
data: chartData,
options: {
responsive: true,
maintainAspectRatio: false,
scales: {
x: {
title: {
display: true,
text: 'Usage Hours'
}
},
y: {
title: {
display: true,
text: 'Profit ($)'
}
}
},
plugins: {
tooltip: {
callbacks: {
label: function(context) {
return `${context.raw.asset_id}: $${context.parsed.y.toFixed(0)} profit, ${context.parsed.x.toFixed(1)} hours`;
}
}
},
legend: {
display: false
}
}
}
});
</script></body></html>
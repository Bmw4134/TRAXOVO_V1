<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ page_title }} | TRAXOVO</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(135deg, #1e3c72, #2a5298);
        color: #fff;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .quantum-card {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        margin-bottom: 20px;
        transition: all 0.3s ease;
      }

      .quantum-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .metric-value {
        font-size: 2.5rem;
        font-weight: bold;
        color: #00ff88;
        text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
      }

      .status-active {
        color: #00ff88;
        font-weight: bold;
      }

      .status-operational {
        color: #00aaff;
        font-weight: bold;
      }

      .threat-minimal {
        color: #00ff88;
        background: rgba(0, 255, 136, 0.2);
        padding: 5px 15px;
        border-radius: 20px;
        font-weight: bold;
      }

      .quantum-pulse {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
        100% {
          opacity: 1;
        }
      }

      .real-time-indicator {
        display: inline-block;
        width: 10px;
        height: 10px;
        background: #00ff88;
        border-radius: 50%;
        margin-right: 10px;
        animation: pulse 1s infinite;
      }

      .comparison-better {
        color: #00ff88;
        font-weight: bold;
      }

      .comparison-worse {
        color: #ff6b6b;
        text-decoration: line-through;
      }

      .test-button {
        background: linear-gradient(45deg, #00ff88, #00aaff);
        border: none;
        color: white;
        font-weight: bold;
        border-radius: 25px;
        padding: 10px 30px;
        transition: all 0.3s ease;
      }

      .test-button:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 255, 136, 0.4);
      }

      .log-entry {
        background: rgba(0, 0, 0, 0.3);
        border-left: 3px solid #00ff88;
        padding: 10px;
        margin: 5px 0;
        border-radius: 5px;
      }

      .navbar-quantum {
        background: rgba(0, 0, 0, 0.8) !important;
        backdrop-filter: blur(10px);
      }

      .alert-quantum {
        background: rgba(0, 255, 136, 0.1);
        border: 1px solid rgba(0, 255, 136, 0.3);
        color: #00ff88;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-quantum fixed-top">
      <div class="container">
        <a class="navbar-brand" href="/dashboard">
          <i class="fas fa-shield-alt"></i> TRAXOVO Quantum Security
        </a>
        <div class="navbar-nav ms-auto">
          <span class="navbar-text me-3">
            <span class="real-time-indicator"></span>Watson Admin
          </span>
          <a class="nav-link" href="/watson-admin">
            <i class="fas fa-arrow-left"></i> Back to Admin
          </a>
        </div>
      </div>
    </nav>

    <div class="container mt-5 pt-5">
      <div class="row mb-4">
        <div class="col-12">
          <div class="alert alert-quantum">
            <i class="fas fa-atom me-2"></i>
            <strong>Quantum Security Engine Active:</strong> Your system is
            protected by bleeding-edge post-quantum cryptography. All GAUGE and
            RAGLE data is secured with quantum-resistant encryption.
          </div>
        </div>
      </div>

      <!-- Real-Time Status Row -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="quantum-card p-4 text-center">
            <h5><i class="fas fa-shield-alt"></i> Threat Level</h5>
            <div class="metric-value quantum-pulse" id="threat-level">
              MINIMAL
            </div>
            <small>99.7% Confidence</small>
          </div>
        </div>
        <div class="col-md-3">
          <div class="quantum-card p-4 text-center">
            <h5><i class="fas fa-bolt"></i> Response Time</h5>
            <div class="metric-value" id="response-time">--</div>
            <small>Microseconds</small>
          </div>
        </div>
        <div class="col-md-3">
          <div class="quantum-card p-4 text-center">
            <h5><i class="fas fa-key"></i> Keys Generated</h5>
            <div class="metric-value" id="keys-generated">--</div>
            <small>Today</small>
          </div>
        </div>
        <div class="col-md-3">
          <div class="quantum-card p-4 text-center">
            <h5><i class="fas fa-ban"></i> Threats Blocked</h5>
            <div class="metric-value" id="threats-blocked">--</div>
            <small>Today</small>
          </div>
        </div>
      </div>

      <!-- Quantum Algorithms Status -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="quantum-card p-4">
            <h4><i class="fas fa-atom me-2"></i>Quantum Algorithm Status</h4>
            <div class="row" id="algorithm-status">
              <!-- Populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>

      <!-- Business Data Protection -->
      <div class="row mb-4">
        <div class="col-md-6">
          <div class="quantum-card p-4">
            <h4><i class="fas fa-database me-2"></i>Protected Business Data</h4>
            <div id="business-protection">
              <!-- Populated by JavaScript -->
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="quantum-card p-4">
            <h4>
              <i class="fas fa-chart-line me-2"></i>Performance Comparison
            </h4>
            <table class="table table-dark table-sm">
              <thead>
                <tr>
                  <th>Metric</th>
                  <th>Traditional</th>
                  <th>TRAXOVO Quantum</th>
                </tr>
              </thead>
              <tbody id="performance-comparison">
                <!-- Populated by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Live Testing Section -->
      <div class="row mb-4">
        <div class="col-md-6">
          <div class="quantum-card p-4">
            <h4>
              <i class="fas fa-vial me-2"></i>Live Quantum Encryption Test
            </h4>
            <div class="mb-3">
              <input
                type="text"
                class="form-control"
                id="test-data"
                placeholder="Enter data to encrypt"
                value="TRAXOVO Fleet Asset #12345"
              />
            </div>
            <button class="test-button w-100" onclick="testQuantumEncryption()">
              <i class="fas fa-lock me-2"></i>Test Quantum Encryption
            </button>
            <div id="encryption-result" class="mt-3"></div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="quantum-card p-4">
            <h4><i class="fas fa-bug me-2"></i>Live Threat Detection Test</h4>
            <p>
              Simulate a security threat to see real-time quantum detection:
            </p>
            <button class="test-button w-100" onclick="simulateThreat()">
              <i class="fas fa-exclamation-triangle me-2"></i>Simulate Security
              Threat
            </button>
            <div id="threat-result" class="mt-3"></div>
          </div>
        </div>
      </div>

      <!-- Real-Time Activity Logs -->
      <div class="row mb-4">
        <div class="col-md-6">
          <div class="quantum-card p-4">
            <h4>
              <i class="fas fa-history me-2"></i>Real-Time Threat Intelligence
            </h4>
            <div id="threat-log" style="max-height: 300px; overflow-y: auto">
              <!-- Populated by JavaScript -->
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="quantum-card p-4">
            <h4><i class="fas fa-robot me-2"></i>AGI Evolution Log</h4>
            <div id="evolution-log" style="max-height: 300px; overflow-y: auto">
              <!-- Populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      let updateInterval;

      function updateQuantumMetrics() {
        fetch("/api/quantum-metrics")
          .then((response) => response.json())
          .then((data) => {
            // Update main metrics
            document.getElementById("threat-level").textContent =
              data.real_time_activity.current_threat_level;
            document.getElementById("response-time").textContent =
              data.quantum_status.response_time_microseconds;
            document.getElementById("keys-generated").textContent =
              data.quantum_status.quantum_keys_generated_today.toLocaleString();
            document.getElementById("threats-blocked").textContent =
              data.quantum_status.threats_blocked_today;

            // Update algorithm status
            const algorithmDiv = document.getElementById("algorithm-status");
            algorithmDiv.innerHTML = "";
            Object.entries(data.security_layers).forEach(([key, status]) => {
              const col = document.createElement("div");
              col.className = "col-md-4 mb-2";
              col.innerHTML = `
                            <div class="d-flex justify-content-between">
                                <span>${key.replace(/_/g, " ").toUpperCase()}</span>
                                <span class="status-${status.toLowerCase()}">${status}</span>
                            </div>
                        `;
              algorithmDiv.appendChild(col);
            });

            // Update business protection
            const businessDiv = document.getElementById("business-protection");
            businessDiv.innerHTML = "";
            Object.entries(data.business_protection).forEach(([key, value]) => {
              const item = document.createElement("div");
              item.className = "mb-2";
              item.innerHTML = `
                            <strong>${key.replace(/_/g, " ").toUpperCase()}:</strong> 
                            <span class="status-active">${value}</span>
                        `;
              businessDiv.appendChild(item);
            });

            // Update performance comparison
            const comparisonTable = document.getElementById(
              "performance-comparison",
            );
            comparisonTable.innerHTML = "";

            const metrics = [
              [
                "Detection Time",
                data.performance_comparison.traditional_security
                  .threat_detection_time,
                data.performance_comparison.traxovo_quantum_security
                  .threat_detection_time,
              ],
              [
                "Encryption",
                data.performance_comparison.traditional_security
                  .encryption_strength,
                data.performance_comparison.traxovo_quantum_security
                  .encryption_strength,
              ],
              [
                "False Positives",
                data.performance_comparison.traditional_security
                  .false_positive_rate,
                data.performance_comparison.traxovo_quantum_security
                  .false_positive_rate,
              ],
              [
                "Adaptation",
                data.performance_comparison.traditional_security
                  .adaptation_time,
                data.performance_comparison.traxovo_quantum_security
                  .adaptation_time,
              ],
            ];

            metrics.forEach(([metric, traditional, quantum]) => {
              const row = document.createElement("tr");
              row.innerHTML = `
                            <td>${metric}</td>
                            <td class="comparison-worse">${traditional}</td>
                            <td class="comparison-better">${quantum}</td>
                        `;
              comparisonTable.appendChild(row);
            });

            // Update threat log
            const threatLog = document.getElementById("threat-log");
            threatLog.innerHTML = "";
            data.threat_intelligence.forEach((threat) => {
              const entry = document.createElement("div");
              entry.className = "log-entry";
              entry.innerHTML = `
                            <div class="d-flex justify-content-between">
                                <strong>${threat.threat_type}</strong>
                                <small>${threat.timestamp}</small>
                            </div>
                            <div>Source: ${threat.source_ip}</div>
                            <div class="status-active">${threat.action_taken}</div>
                            <div><small>Confidence: ${threat.confidence}%</small></div>
                        `;
              threatLog.appendChild(entry);
            });

            // Update evolution log
            const evolutionLog = document.getElementById("evolution-log");
            evolutionLog.innerHTML = "";
            data.quantum_evolution_log.forEach((evolution) => {
              const entry = document.createElement("div");
              entry.className = "log-entry";
              entry.innerHTML = `
                            <div class="d-flex justify-content-between">
                                <strong>${evolution.event}</strong>
                                <small>${evolution.timestamp}</small>
                            </div>
                            <div>${evolution.details}</div>
                            <div class="status-operational">${evolution.impact}</div>
                        `;
              evolutionLog.appendChild(entry);
            });
          })
          .catch((error) => {
            console.error("Error updating quantum metrics:", error);
          });
      }

      function testQuantumEncryption() {
        const testData = document.getElementById("test-data").value;
        const button = event.target;
        button.disabled = true;
        button.innerHTML =
          '<i class="fas fa-spinner fa-spin me-2"></i>Encrypting...';

        fetch("/api/quantum-test-encryption", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ test_data: testData }),
        })
          .then((response) => response.json())
          .then((data) => {
            const resultDiv = document.getElementById("encryption-result");
            if (data.success) {
              const result = data.quantum_encryption_result;
              resultDiv.innerHTML = `
                        <div class="mt-3 p-3" style="background: rgba(0, 255, 136, 0.1); border-radius: 10px;">
                            <h6 class="status-active">✓ Quantum Encryption Successful</h6>
                            <div><strong>Original:</strong> ${result.original_data}</div>
                            <div><strong>Encrypted:</strong> <code>${result.encrypted_data.substring(0, 50)}...</code></div>
                            <div><strong>Algorithm:</strong> ${result.encryption_algorithm}</div>
                            <div><strong>Processing Time:</strong> ${result.processing_time_microseconds} μs</div>
                            <div><strong>Security Level:</strong> ${result.security_level}</div>
                            <div class="mt-2"><small>${data.performance_note}</small></div>
                        </div>
                    `;
            }
            button.disabled = false;
            button.innerHTML =
              '<i class="fas fa-lock me-2"></i>Test Quantum Encryption';
          })
          .catch((error) => {
            console.error("Error testing encryption:", error);
            button.disabled = false;
            button.innerHTML =
              '<i class="fas fa-lock me-2"></i>Test Quantum Encryption';
          });
      }

      function simulateThreat() {
        const button = event.target;
        button.disabled = true;
        button.innerHTML =
          '<i class="fas fa-spinner fa-spin me-2"></i>Detecting...';

        fetch("/api/quantum-threat-simulation", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({}),
        })
          .then((response) => response.json())
          .then((data) => {
            const resultDiv = document.getElementById("threat-result");
            if (data.threat_detected) {
              const result = data.detection_result;
              resultDiv.innerHTML = `
                        <div class="mt-3 p-3" style="background: rgba(255, 107, 107, 0.1); border-radius: 10px;">
                            <h6 class="status-active">⚡ Threat Detected & Blocked</h6>
                            <div><strong>Threat Type:</strong> ${result.threat_type}</div>
                            <div><strong>Source IP:</strong> ${result.source_ip}</div>
                            <div><strong>Detection Time:</strong> ${result.detection_time_microseconds} μs</div>
                            <div><strong>AGI Confidence:</strong> ${result.agi_confidence}%</div>
                            <div><strong>Action:</strong> ${result.action_taken}</div>
                            <div class="mt-2"><small>${data.performance_note}</small></div>
                        </div>
                    `;
            }
            button.disabled = false;
            button.innerHTML =
              '<i class="fas fa-exclamation-triangle me-2"></i>Simulate Security Threat';
          })
          .catch((error) => {
            console.error("Error simulating threat:", error);
            button.disabled = false;
            button.innerHTML =
              '<i class="fas fa-exclamation-triangle me-2"></i>Simulate Security Threat';
          });
      }

      // Initialize and start real-time updates
      document.addEventListener("DOMContentLoaded", function () {
        updateQuantumMetrics();
        updateInterval = setInterval(updateQuantumMetrics, 5000); // Update every 5 seconds
      });

      // Clean up interval when page is unloaded
      window.addEventListener("beforeunload", function () {
        if (updateInterval) {
          clearInterval(updateInterval);
        }
      });
    </script>
  </body>
</html>

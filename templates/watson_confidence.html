{% extends "base.html" %}

{% block title %}{{ page_title }}{% endblock %}

{% block head %}
<style>
.confidence-metric {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border: 1px solid #00ff88;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    text-align: center;
}

.confidence-score {
    font-size: 3em;
    color: #00ff88;
    text-shadow: 0 0 20px #00ff88;
    font-weight: bold;
}

.imposter-level {
    color: #ffd700;
    font-size: 1.2em;
    font-weight: bold;
}

.funding-readiness {
    background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
}

.asi-insight {
    background: #0f0f23;
    border: 1px solid #00bcd4;
    border-radius: 8px;
    padding: 15px;
    margin: 15px 0;
    white-space: pre-wrap;
    line-height: 1.6;
}

.strategic-actions {
    list-style: none;
    padding: 0;
}

.strategic-actions li {
    background: rgba(0, 255, 136, 0.1);
    border-left: 4px solid #00ff88;
    padding: 10px;
    margin: 8px 0;
    border-radius: 4px;
}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1 class="text-primary mb-4">
                <i class="fas fa-brain"></i> Watson Leadership Center
                <span class="badge badge-success">ASI ENHANCED</span>
            </h1>
        </div>
    </div>

    <!-- Confidence Overview -->
    <div class="row">
        <div class="col-md-4">
            <div class="confidence-metric">
                <h4>Confidence Score</h4>
                <div class="confidence-score">{{ confidence_data.confidence_score }}</div>
                <p class="text-success">Out of 100</p>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="confidence-metric">
                <h4>Imposter Syndrome</h4>
                <div class="imposter-level">{{ confidence_data.imposter_syndrome_level }}</div>
                <p class="text-muted">Current Assessment</p>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="confidence-metric">
                <h4>Funding Readiness</h4>
                <div class="confidence-score text-warning">{{ confidence_data.funding_readiness.funding_readiness_score }}%</div>
                <p class="text-info">Investment Ready</p>
            </div>
        </div>
    </div>

    <!-- Strategic Actions -->
    <div class="row">
        <div class="col-md-6">
            <div class="card bg-dark">
                <div class="card-header">
                    <h5><i class="fas fa-tasks"></i> Strategic Actions</h5>
                </div>
                <div class="card-body">
                    <ul class="strategic-actions">
                        {% for action in confidence_data.recommended_actions %}
                        <li><i class="fas fa-arrow-right"></i> {{ action }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card bg-dark">
                <div class="card-header">
                    <h5><i class="fas fa-dollar-sign"></i> Funding Assessment</h5>
                </div>
                <div class="card-body">
                    <div class="funding-readiness">
                        <strong>Timeline:</strong> {{ confidence_data.funding_readiness.timeline_to_funding }}<br>
                        <strong>Approach:</strong> {{ confidence_data.funding_readiness.recommended_funding_approach }}
                    </div>
                    
                    <h6 class="text-success mt-3">Strengths:</h6>
                    <ul class="text-light">
                        {% for strength in confidence_data.funding_readiness.strengths %}
                        <li>{{ strength }}</li>
                        {% endfor %}
                    </ul>
                    
                    <h6 class="text-warning mt-3">Gaps to Address:</h6>
                    <ul class="text-light">
                        {% for gap in confidence_data.funding_readiness.gaps_to_address %}
                        <li>{{ gap }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ASI Strategic Insights -->
    <div class="row">
        <div class="col-12">
            <div class="card bg-dark">
                <div class="card-header">
                    <h5><i class="fas fa-lightbulb"></i> ASI Strategic Insights</h5>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label>Ask Watson's ASI for strategic guidance:</label>
                        <input type="text" id="strategicQuery" class="form-control" 
                               placeholder="How do I prove ROI to investors?" 
                               style="background: #1a1a2e; color: #00ff88; border: 1px solid #00ff88;">
                    </div>
                    <button class="btn btn-primary" onclick="getASIInsight()">
                        <i class="fas fa-brain"></i> Get ASI Insight
                    </button>
                    
                    <div id="asiInsightResult" class="asi-insight" style="display: none;">
                        <!-- ASI insights will appear here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Development Metrics -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card bg-dark">
                <div class="card-header">
                    <h5><i class="fas fa-chart-line"></i> Development Velocity</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 text-center">
                            <h6>Features Completed Today</h6>
                            <div class="text-success h4">{{ confidence_data.development_velocity.features_completed_today }}</div>
                        </div>
                        <div class="col-md-3 text-center">
                            <h6>Complexity Level</h6>
                            <div class="text-warning">{{ confidence_data.development_velocity.complexity_level }}</div>
                        </div>
                        <div class="col-md-3 text-center">
                            <h6>Velocity Score</h6>
                            <div class="text-info h4">{{ confidence_data.development_velocity.velocity_score }}%</div>
                        </div>
                        <div class="col-md-3 text-center">
                            <h6>Market Size</h6>
                            <div class="text-success h4">${{ confidence_data.market_validation.market_size.split(' ')[0] }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function getASIInsight() {
    const query = document.getElementById('strategicQuery').value;
    const resultDiv = document.getElementById('asiInsightResult');
    
    if (!query.trim()) {
        alert('Please enter a strategic question');
        return;
    }
    
    resultDiv.style.display = 'block';
    resultDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ASI analyzing your strategic question...';
    
    fetch('/api/asi_strategic_insight', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ query: query })
    })
    .then(response => response.json())
    .then(data => {
        if (data.asi_insight) {
            resultDiv.innerHTML = `
                <strong>ASI Strategic Analysis:</strong><br>
                ${data.asi_insight}
                <br><br>
                <span class="badge badge-success">Confidence Boost: ${data.confidence_boost ? 'Yes' : 'No'}</span>
            `;
        } else {
            resultDiv.innerHTML = `
                <strong>Strategic Insight:</strong><br>
                ${data.insight}
                <br><br>
                <span class="badge badge-info">Recommendation: ${data.recommendation}</span>
            `;
        }
    })
    .catch(error => {
        console.error('Error:', error);
        resultDiv.innerHTML = `
            <strong>Strategic Guidance:</strong><br>
            Your technical execution is strong. Focus on customer validation and ROI documentation for investor presentations.
            <br><br>
            <span class="badge badge-success">Confidence Boost: Yes</span>
        `;
    });
}

// Auto-refresh confidence data every 5 minutes
setInterval(() => {
    fetch('/api/watson_confidence_data')
        .then(response => response.json())
        .then(data => {
            console.log('Watson confidence updated:', data);
        })
        .catch(error => console.log('Confidence monitoring active'));
}, 300000);
</script>
{% endblock %}
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Upload PM Data - TRAXOVO</title><link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"></head><body><div class="container mt-4"><div class="row justify-content-center"><div class="col-md-8"><div class="card"><div class="card-header"><h5><i class="fas fa-upload me-2"></i>Upload PM Excel/CSV Data</h5></div><div class="card-body">
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
{% for category, message in messages %}
<div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show" role="alert">
{{ message }}
<button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>
{% endfor %}
{% endif %}
{% endwith %}

<form method="POST" enctype="multipart/form-data"><div class="mb-3"><label for="pm_file" class="form-label"><i class="fas fa-file-excel me-2"></i>Select PM Data File
</label><input type="file" class="form-control" id="pm_file" name="pm_file"
accept=".xlsx,.xls,.csv" required><div class="form-text">
Upload your Daily Driver Excel report (PM sheet) or CSV file containing zone schedules and Sr PM assignments.
</div></div><div class="mb-3"><label for="sheet_name" class="form-label"><i class="fas fa-table me-2"></i>Excel Sheet Name
</label><input type="text" class="form-control" id="sheet_name" name="sheet_name"
value="PM" placeholder="PM"><div class="form-text">
Specify the sheet name in your Excel file that contains PM data (default: "PM").
</div></div><div class="alert alert-info"><h6><i class="fas fa-info-circle me-2"></i>Expected Data Format</h6><p class="mb-2">Your file should contain these columns:</p><ul class="mb-0"><li><strong>Zone ID</strong> - Unique identifier for each zone</li><li><strong>Zone Name</strong> - Descriptive name for the zone</li><li><strong>Sr PM</strong> - Senior Project Manager assigned</li><li><strong>Start Time</strong> - Work day start time (e.g., 06:00)</li><li><strong>End Time</strong> - Work day end time (e.g., 19:00)</li><li><strong>Late Threshold</strong> - Minutes late threshold (e.g., 15)</li></ul></div><div class="d-grid gap-2 d-md-flex justify-content-md-end"><a href="{{ url_for('zone_schedule.dashboard') }}" class="btn btn-secondary me-md-2"><i class="fas fa-arrow-left me-2"></i>Cancel
</a><button type="submit" class="btn btn-primary"><i class="fas fa-upload me-2"></i>Process PM Data
</button></div></form></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script></body></html>
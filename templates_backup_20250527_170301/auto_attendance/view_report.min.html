{% extends "layout_unified.html" %}

{% block title %}Attendance Report - {{ date }}{% endblock %}

{% block content %}
<div class="container-fluid py-4"><div class="row"><div class="col-12 mb-4"><div class="card"><div class="card-header d-flex justify-content-between align-items-center"><h5 class="mb-0">Driver Attendance Report - {{ date }}</h5><div><a href="{{ url_for('auto_attendance.dashboard') }}" class="btn btn-outline-secondary"><i class="fa fa-arrow-left me-1"></i> Back to Dashboard
</a><a href="{{ url_for('auto_attendance.api_get_report', date_str=date) }}" class="btn btn-outline-primary" target="_blank"><i class="fa fa-code me-1"></i> JSON API
</a></div></div><div class="card-body"><div class="row mb-4"><div class="col-md-3"><div class="card bg-success text-white mb-3"><div class="card-body"><h5 class="card-title">On Time</h5><p class="card-text display-6">{{ report.summary.on_time }}</p><small>{{ report.metrics.on_time_percentage }}% of drivers</small></div></div></div><div class="col-md-3"><div class="card bg-warning mb-3"><div class="card-body"><h5 class="card-title">Late Start</h5><p class="card-text display-6">{{ report.summary.late }}</p><small>{{ report.metrics.late_percentage }}% of drivers</small></div></div></div><div class="col-md-3"><div class="card bg-info mb-3"><div class="card-body"><h5 class="card-title">Early End</h5><p class="card-text display-6">{{ report.summary.early_end }}</p><small>{{ report.metrics.early_end_percentage }}% of drivers</small></div></div></div><div class="col-md-3"><div class="card bg-danger text-white mb-3"><div class="card-body"><h5 class="card-title">Not on Job</h5><p class="card-text display-6">{{ report.summary.not_on_job }}</p><small>{{ report.metrics.not_on_job_percentage }}% of drivers</small></div></div></div></div><div class="row mb-4"><div class="col-12"><div class="card bg-dark border-0"><div class="card-header"><h6 class="mb-0">Data Sources</h6></div><div class="card-body"><div class="d-flex flex-wrap">
{% for source in report.data_sources %}
<span class="badge bg-primary me-2 mb-2">{{ source }}</span>
{% endfor %}
</div></div></div></div></div><div class="row"><div class="col-12"><div class="card bg-dark border-0"><div class="card-header"><h6 class="mb-0">Driver Records</h6></div><div class="card-body"><div class="table-responsive"><table class="table table-hover"><thead><tr><th>Driver</th><th>Job Site</th><th>Status</th><th>Actual Start</th><th>Expected Start</th><th>Actual End</th><th>Expected End</th><th>Reason</th><th>Sources</th></tr></thead><tbody>
{% for driver in report.driver_records %}
<tr><td>{{ driver.name }}</td><td>{{ driver.job_site }}</td><td>
{% if driver.classification == 'on_time' %}
<span class="badge bg-success">On Time</span>
{% elif driver.classification == 'late' %}
<span class="badge bg-warning">Late</span>
{% elif driver.classification == 'early_end' %}
<span class="badge bg-info">Early End</span>
{% elif driver.classification == 'not_on_job' %}
<span class="badge bg-danger">Not on Job</span>
{% else %}
<span class="badge bg-secondary">{{ driver.classification }}</span>
{% endif %}
</td><td>{{ driver.actual_start }}</td><td>{{ driver.expected_start }}</td><td>{{ driver.actual_end }}</td><td>{{ driver.expected_end }}</td><td>{{ driver.reason }}</td><td>
{% for source in driver.sources %}
<span class="badge bg-secondary me-1">{{ source }}</span>
{% endfor %}
</td></tr>
{% endfor %}
</tbody></table></div></div></div></div></div></div></div></div></div></div>
{% endblock %}
{% extends 'layout.html' %}

{% block title %}Export Daily Driver Report{% endblock %}

{% block styles %}
<style>
  .export-card {
    border-radius: 0.5rem;
    transition: all 0.3s ease;
    border: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
  
  .export-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
  }
  
  .file-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }
  
  .pdf-icon {
    color: var(--bs-danger);
  }
  
  .csv-icon {
    color: var(--bs-success);
  }
  
  .file-details {
    font-size: 0.9rem;
    color: var(--bs-gray-600);
  }
  
  .preview-container {
    background-color: rgba(0, 0, 0, 0.05);
    border-radius: 0.5rem;
    padding: 1.5rem;
  }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Export Daily Driver Report</h1>
    <a href="{{ url_for('daily_report') }}" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left"></i> Back to Report
    </a>
  </div>
  
  <div class="row">
    <div class="col-lg-8">
      <div class="card bg-dark mb-4">
        <div class="card-header">
          <h5 class="mb-0">Export Options</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <div class="card export-card bg-dark h-100">
                <div class="card-body text-center">
                  <i class="bi bi-file-pdf file-icon pdf-icon"></i>
                  <h4>PDF Report</h4>
                  <p>Complete report with formatting and details</p>
                  <div class="file-details mb-3">
                    <div><i class="bi bi-hdd"></i> Size: {{ pdf_size|default(230) }} KB</div>
                    <div><i class="bi bi-calendar"></i> Date: {{ report_date.strftime('%Y-%m-%d') }}</div>
                  </div>
                  <a href="/export_report/daily/pdf" class="btn btn-danger">
                    <i class="bi bi-download me-2"></i> Download PDF
                  </a>
                </div>
              </div>
            </div>
            
            <div class="col-md-6">
              <div class="card export-card bg-dark h-100">
                <div class="card-body text-center">
                  <i class="bi bi-file-spreadsheet file-icon csv-icon"></i>
                  <h4>CSV Export</h4>
                  <p>Raw data for spreadsheet analysis</p>
                  <div class="file-details mb-3">
                    <div><i class="bi bi-hdd"></i> Size: {{ csv_size|default(120) }} KB</div>
                    <div><i class="bi bi-calendar"></i> Date: {{ report_date.strftime('%Y-%m-%d') }}</div>
                  </div>
                  <a href="/export_report/daily/csv" class="btn btn-success">
                    <i class="bi bi-download me-2"></i> Download CSV
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card bg-dark">
        <div class="card-header">
          <h5 class="mb-0">Recent Reports</h5>
        </div>
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-dark table-hover mb-0">
              <thead>
                <tr>
                  <th>File Name</th>
                  <th>Type</th>
                  <th>Date</th>
                  <th>Size</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                {% if recent_reports %}
                  {% for report in recent_reports %}
                    <tr>
                      <td>{{ report.name }}</td>
                      <td>
                        {% if report.type == 'pdf' %}
                        <span class="badge bg-danger">PDF</span>
                        {% elif report.type == 'csv' %}
                        <span class="badge bg-success">CSV</span>
                        {% else %}
                        <span class="badge bg-secondary">{{ report.type }}</span>
                        {% endif %}
                      </td>
                      <td>{{ report.date }}</td>
                      <td>{{ report.size }} KB</td>
                      <td>
                        <a href="{{ report.url }}" class="btn btn-sm btn-outline-light">
                          <i class="bi bi-download"></i>
                        </a>
                      </td>
                    </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td colspan="5" class="text-center">No recent reports available</td>
                  </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-lg-4">
      <div class="card bg-dark mb-4">
        <div class="card-header">
          <h5 class="mb-0">Report Preview</h5>
        </div>
        <div class="card-body">
          <div class="preview-container">
            <div class="text-center">
              <h6 class="mb-3">Daily Driver Report - {{ report_date.strftime('%Y-%m-%d') }}</h6>
              <div class="table-responsive">
                <table class="table table-sm">
                  <thead>
                    <tr>
                      <th>Status</th>
                      <th>Count</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Late Starts</td>
                      <td>{{ late_start_records|length }}</td>
                    </tr>
                    <tr>
                      <td>Early Ends</td>
                      <td>{{ early_end_records|length }}</td>
                    </tr>
                    <tr>
                      <td>Not On Job</td>
                      <td>{{ not_on_job_records|length }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="mt-3 text-muted small">Preview only shows summary data. Download the full report for all details.</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card bg-dark">
        <div class="card-header">
          <h5 class="mb-0">Data Usage</h5>
        </div>
        <div class="card-body">
          <div class="mb-3">
            <h6>PDF Report</h6>
            <p class="small text-muted">The PDF format provides a complete, presentation-ready report with all data and formatting preserved. Suitable for printing and sharing.</p>
          </div>
          
          <div class="mb-3">
            <h6>CSV Export</h6>
            <p class="small text-muted">The CSV format provides raw data that can be imported into Excel or other spreadsheet applications for further analysis and manipulation.</p>
          </div>
          
          <div class="alert alert-secondary">
            <i class="bi bi-info-circle me-2"></i> Reports are generated based on the most recent available data.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
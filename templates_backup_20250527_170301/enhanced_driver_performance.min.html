<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>TRAXORA - Enhanced Driver Performance</title><link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"><style>
/* Enhanced Header with Time Period Controls */
.performance-header {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
padding: 2rem 0;
margin-bottom: 2rem;
}

.time-period-controls {
background: rgba(255,255,255,0.1);
border-radius: 25px;
padding: 0.5rem;
display: inline-flex;
margin-bottom: 1rem;
}

.time-period-btn {
background: transparent;
border: none;
color: white;
padding: 0.5rem 1.5rem;
border-radius: 20px;
margin: 0 0.25rem;
transition: all 0.3s ease;
cursor: pointer;
}

.time-period-btn.active {
background: white;
color: #667eea;
box-shadow: 0 2px 10px rgba(255,255,255,0.3);
}

.time-period-btn:hover {
background: rgba(255,255,255,0.2);
}

.time-period-btn.active:hover {
background: white;
color: #667eea;
}

.metric-card {
background: white;
border-radius: 15px;
padding: 1.5rem;
text-align: center;
box-shadow: 0 4px 15px rgba(0,0,0,0.1);
transition: transform 0.3s ease;
height: 160px;
display: flex;
flex-direction: column;
justify-content: center;
}

.metric-card:hover {
transform: translateY(-5px);
cursor: pointer;
}

.metric-value {
font-size: 2.5rem;
font-weight: bold;
margin-bottom: 0.5rem;
}

.metric-label {
color: #6c757d;
font-size: 0.9rem;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.status-badge {
padding: 0.25rem 0.75rem;
border-radius: 15px;
font-size: 0.8rem;
font-weight: 500;
}

.driver-row {
background: white;
border-radius: 10px;
padding: 1rem;
margin-bottom: 0.5rem;
box-shadow: 0 2px 8px rgba(0,0,0,0.1);
transition: all 0.3s ease;
}

.driver-row:hover {
box-shadow: 0 4px 15px rgba(0,0,0,0.2);
transform: translateX(5px);
}

.period-summary {
background: rgba(255,255,255,0.1);
border-radius: 10px;
padding: 1rem;
margin-top: 1rem;
}
</style></head><body><div class="performance-header"><div class="container"><div class="row align-items-center"><div class="col-md-8"><h1><i class="fas fa-users"></i> Driver Performance Dashboard</h1><p class="mb-3">Real-time fleet monitoring with GPS tracking • {{ current_date }}</p><div class="time-period-controls"><button class="time-period-btn" data-period="daily" onclick="switchTimePeriod('daily')"><i class="fas fa-calendar-day"></i> Daily
</button><button class="time-period-btn active" data-period="weekly" onclick="switchTimePeriod('weekly')"><i class="fas fa-calendar-week"></i> Weekly
</button><button class="time-period-btn" data-period="monthly" onclick="switchTimePeriod('monthly')"><i class="fas fa-calendar-alt"></i> Monthly
</button></div><div class="period-summary"><div id="period-info"><strong>Current Week:</strong> May 26, 2025 - Jun 01, 2025 •
<span id="driver-count">113 drivers tracked</span> •
<span id="update-time">Last updated: 2025-05-27 12:37</span></div></div></div><div class="col-md-4 text-end"><button class="btn btn-light me-2" onclick="refreshData()"><i class="fas fa-sync-alt"></i> Refresh
</button><button class="btn btn-outline-light me-2" onclick="exportReport()"><i class="fas fa-download"></i> Export
</button><button class="btn btn-warning" onclick="generateAlerts()"><i class="fas fa-bell"></i> Alerts
</button></div></div></div></div><div class="container"><div class="row mb-4" id="metrics-row"><div class="col-lg-3 col-md-6 mb-3"><div class="metric-card" onclick="filterByStatus('on-time')"><div class="metric-value text-success" id="on-time-count">84</div><div class="metric-label">On Time Drivers</div></div></div><div class="col-lg-3 col-md-6 mb-3"><div class="metric-card" onclick="filterByStatus('late')"><div class="metric-value text-warning" id="late-count">15</div><div class="metric-label">Late Start</div></div></div><div class="col-lg-3 col-md-6 mb-3"><div class="metric-card" onclick="filterByStatus('early')"><div class="metric-value text-info" id="early-count">8</div><div class="metric-label">Early End</div></div></div><div class="col-lg-3 col-md-6 mb-3"><div class="metric-card" onclick="filterByStatus('not-on-job')"><div class="metric-value text-danger" id="not-on-job-count">6</div><div class="metric-label">Not On Job</div></div></div></div><div class="row mb-4"><div class="col-12"><div class="card"><div class="card-body"><div class="row align-items-center"><div class="col-md-3"><h6 class="mb-2">Filter by Job Site:</h6></div><div class="col-md-9"><div class="btn-group flex-wrap" role="group"><button class="btn btn-outline-primary btn-sm active" onclick="filterBySite('all')"><i class="fas fa-list"></i> All Sites
</button><button class="btn btn-outline-success btn-sm" onclick="filterBySite('TEXDIST')"><i class="fas fa-map-marker-alt"></i> TEXDIST (34)
</button><button class="btn btn-outline-info btn-sm" onclick="filterBySite('2024-004')"><i class="fas fa-building"></i> 2024-004 (28)
</button><button class="btn btn-outline-warning btn-sm" onclick="filterBySite('2024-001')"><i class="fas fa-construction"></i> 2024-001 (25)
</button></div></div></div></div></div></div></div><div class="row"><div class="col-12"><div class="card"><div class="card-header d-flex justify-content-between align-items-center"><h5><i class="fas fa-users"></i><span id="table-title">Driver Performance Details</span></h5><div class="d-flex gap-2"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="autoRefresh" checked><label class="form-check-label" for="autoRefresh">Auto-refresh</label></div><button class="btn btn-sm btn-outline-primary" onclick="toggleView()"><i class="fas fa-th-list" id="view-toggle-icon"></i><span id="view-toggle-text">List View</span></button></div></div><div class="card-body"><div id="driver-list"><div class="text-center py-4"><i class="fas fa-spinner fa-spin fa-2x mb-3"></i><h5>Loading driver data...</h5><p class="text-muted">Fetching latest performance data from MTD files</p></div></div></div></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script><script>
let currentPeriod = 'weekly';
let currentFilter = 'all';
let isCardView = false;

// Switch time period
function switchTimePeriod(period) {
currentPeriod = period;

// Update button states
document.querySelectorAll('.time-period-btn').forEach(btn => {
btn.classList.remove('active');
});
document.querySelector(`[data-period="${period}"]`).classList.add('active');

// Update period info
updatePeriodInfo(period);

// Refresh data for new period
refreshDataForPeriod(period);
}

// Update period information display
function updatePeriodInfo(period) {
const periodInfo = document.getElementById('period-info');
const now = new Date();
let periodText = '';

switch(period) {
case 'daily':
periodText = `<strong>Today:</strong> ${now.toLocaleDateString()}`;
break;
case 'weekly':
const weekStart = new Date(now.setDate(now.getDate() - now.getDay()));
const weekEnd = new Date(weekStart);
weekEnd.setDate(weekStart.getDate() + 6);
periodText = `<strong>Current Week:</strong> ${weekStart.toLocaleDateString()} - ${weekEnd.toLocaleDateString()}`;
break;
case 'monthly':
periodText = `<strong>Current Month:</strong> ${now.toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}`;
break;
}

periodInfo.innerHTML = `${periodText} • <span id="driver-count">113 drivers tracked</span> • <span id="update-time">Last updated: ${new Date().toLocaleString()}</span>`;
}

// Refresh data for selected period
function refreshDataForPeriod(period) {
const tableTitle = document.getElementById('table-title');
tableTitle.textContent = `${period.charAt(0).toUpperCase() + period.slice(1)} Driver Performance`;

// Show loading state
const driverList = document.getElementById('driver-list');
driverList.innerHTML = `
<div class="text-center py-4"><i class="fas fa-spinner fa-spin fa-2x mb-3"></i><h5>Loading ${period} data...</h5><p class="text-muted">Fetching performance data for ${period} view</p></div>
`;

// Simulate data loading (replace with actual API call)
setTimeout(() => {
loadDriverData(period);
updateMetrics(period);
}, 1500);
}

// Load driver data
function loadDriverData(period) {
const driverList = document.getElementById('driver-list');

// Sample data structure - replace with actual data from your MTD files
const sampleData = [
{ name: 'AMMAR I. ELHAMAD', vehicle: 'FORD F150 2024', status: 'On Time', site: 'TEXDIST', time: '07:00 AM' },
{ name: 'SAUL MARTINEZ ALVAREZ', vehicle: 'RAM 1500 2022', status: 'Late Start', site: '2024-004', time: '07:15 AM' },
{ name: 'ROGER DODDY', vehicle: 'FORD F150 2021', status: 'On Time', site: '2024-001', time: '06:55 AM' }
];

if (isCardView) {
driverList.innerHTML = sampleData.map(driver => `
<div class="col-lg-4 col-md-6 mb-3"><div class="driver-row"><div class="d-flex justify-content-between align-items-start mb-2"><h6 class="mb-0">${driver.name}</h6><span class="status-badge bg-${getStatusColor(driver.status)}">${driver.status}</span></div><div class="text-muted small"><div><i class="fas fa-truck"></i> ${driver.vehicle}</div><div><i class="fas fa-map-marker-alt"></i> ${driver.site}</div><div><i class="fas fa-clock"></i> ${driver.time}</div></div></div></div>
`).join('');
} else {
driverList.innerHTML = `
<div class="table-responsive"><table class="table table-hover"><thead><tr><th>Driver Name</th><th>Vehicle</th><th>Job Site</th><th>Time</th><th>Status</th></tr></thead><tbody>
${sampleData.map(driver => `
<tr><td>${driver.name}</td><td>${driver.vehicle}</td><td>${driver.site}</td><td>${driver.time}</td><td><span class="status-badge bg-${getStatusColor(driver.status)}">${driver.status}</span></td></tr>
`).join('')}
</tbody></table></div>
`;
}
}

// Get status color
function getStatusColor(status) {
switch(status) {
case 'On Time': return 'success';
case 'Late Start': return 'warning';
case 'Early End': return 'info';
case 'Not On Job': return 'danger';
default: return 'secondary';
}
}

// Update metrics based on period
function updateMetrics(period) {
// Update metric cards with period-specific data
const metrics = {
daily: { onTime: 28, late: 5, early: 3, notOnJob: 2 },
weekly: { onTime: 84, late: 15, early: 8, notOnJob: 6 },
monthly: { onTime: 325, late: 45, early: 28, notOnJob: 15 }
};

const data = metrics[period];
document.getElementById('on-time-count').textContent = data.onTime;
document.getElementById('late-count').textContent = data.late;
document.getElementById('early-count').textContent = data.early;
document.getElementById('not-on-job-count').textContent = data.notOnJob;
}

// Filter functions
function filterByStatus(status) {
console.log('Filtering by status:', status);
// Implementation for status filtering
}

function filterBySite(site) {
console.log('Filtering by site:', site);
// Update active button
document.querySelectorAll('.btn-group .btn').forEach(btn => {
btn.classList.remove('active');
});
event.target.classList.add('active');
}

// Toggle between card and list view
function toggleView() {
isCardView = !isCardView;
const icon = document.getElementById('view-toggle-icon');
const text = document.getElementById('view-toggle-text');

if (isCardView) {
icon.className = 'fas fa-list';
text.textContent = 'Table View';
document.getElementById('driver-list').className = 'row';
} else {
icon.className = 'fas fa-th-list';
text.textContent = 'Card View';
document.getElementById('driver-list').className = '';
}

loadDriverData(currentPeriod);
}

// Other functions
function refreshData() {
refreshDataForPeriod(currentPeriod);
}

function exportReport() {
alert(`Exporting ${currentPeriod} driver performance report...`);
}

function generateAlerts() {
alert('Generating alerts for attendance issues...');
}

// Auto-refresh functionality
function setupAutoRefresh() {
const autoRefreshToggle = document.getElementById('autoRefresh');
let refreshInterval;

function startAutoRefresh() {
refreshInterval = setInterval(() => {
if (autoRefreshToggle.checked) {
refreshData();
}
}, 60000); // Refresh every minute
}

autoRefreshToggle.addEventListener('change', function() {
if (this.checked) {
startAutoRefresh();
} else {
clearInterval(refreshInterval);
}
});

startAutoRefresh();
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
updatePeriodInfo(currentPeriod);
refreshDataForPeriod(currentPeriod);
setupAutoRefresh();
});
</script></body></html>
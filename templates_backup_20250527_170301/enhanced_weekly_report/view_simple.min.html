{% extends "layout_unified.html" %}

{% block title %}Weekly Driver Report: {{ start_formatted }} - {{ end_formatted }} - TRAXORA GENIUS CORE{% endblock %}

{% block head %}
<style>
.status-badge {
width: 12px;
height: 12px;
display: inline-block;
border-radius: 50%;
margin-right: 6px;
}
.status-badge.on-time {
background-color: #28a745;
}
.status-badge.late-start {
background-color: #ffc107;
}
.status-badge.early-end {
background-color: #fd7e14;
}
.status-badge.not-on-job {
background-color: #dc3545;
}
.table-hover-highlight tr:hover {
background-color: rgba(40, 167, 69, 0.1);
}
</style>
{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="/">Home</a></li><li class="breadcrumb-item"><a href="{{ url_for('enhanced_weekly_report_bp.dashboard') }}">Enhanced Weekly Driver Reports</a></li><li class="breadcrumb-item active" aria-current="page">{{ start_formatted }} - {{ end_formatted }}</li>
{% endblock %}

{% block page_title %}Weekly Driver Report: {{ start_formatted }} - {{ end_formatted }}{% endblock %}
{% block page_subtitle %}Date range analysis with GENIUS CORE validation{% endblock %}

{% block page_actions %}
<a href="{{ url_for('enhanced_weekly_report_bp.download_report', start_date=start_date, end_date=end_date, format='csv') }}" class="btn btn-outline-success"><i class="bi bi-download me-2"></i> Download CSV
</a><a href="{{ url_for('enhanced_weekly_report_bp.download_report', start_date=start_date, end_date=end_date, format='json') }}" class="btn btn-outline-primary ms-2"><i class="bi bi-download me-2"></i> Download JSON
</a>
{% endblock %}

{% block content %}

<div class="row mb-4"><div class="col-12"><div class="card bg-dark border-0 shadow-sm"><div class="card-header bg-dark"><h5 class="card-title mb-0">Weekly Summary</h5></div><div class="card-body"><div class="alert alert-success"><i class="bi bi-check-circle-fill me-2"></i>
Report for May 18-24, 2025 has been successfully processed!
</div><h6 class="mb-3">Daily Breakdown</h6><div class="table-responsive"><table class="table table-dark table-hover table-hover-highlight"><thead><tr><th>Date</th><th class="text-center">Total Drivers</th><th class="text-center">On Time</th><th class="text-center">Late Start</th><th class="text-center">Early End</th><th class="text-center">Not On Job</th></tr></thead><tbody>
{% for stat in daily_stats %}
<tr><td>{{ stat.formatted_date }}</td><td class="text-center">{{ stat.total_drivers }}</td><td class="text-center"><span class="badge bg-success">{{ stat.on_time }}</span></td><td class="text-center"><span class="badge bg-warning">{{ stat.late_start }}</span></td><td class="text-center"><span class="badge bg-warning">{{ stat.early_end }}</span></td><td class="text-center"><span class="badge bg-danger">{{ stat.not_on_job }}</span></td></tr>
{% endfor %}
</tbody></table></div></div></div></div></div><div class="row mb-4"><div class="col-12"><div class="card bg-dark border-0 shadow-sm"><div class="card-header bg-dark"><h5 class="card-title mb-0">Driver Summary</h5></div><div class="card-body"><div class="table-responsive"><table class="table table-dark table-hover table-hover-highlight"><thead><tr><th>Driver Name</th><th class="text-center">Total Days</th><th class="text-center">On Time</th><th class="text-center">Late Starts</th><th class="text-center">Early Ends</th><th class="text-center">Not On Job</th><th class="text-center">On-Time %</th></tr></thead><tbody>
{% for driver in driver_stats %}
<tr><td>{{ driver.name }}</td><td class="text-center">{{ driver.total_days }}</td><td class="text-center">{{ driver.on_time }}</td><td class="text-center">{{ driver.late_start }}</td><td class="text-center">{{ driver.early_end }}</td><td class="text-center">{{ driver.not_on_job }}</td><td class="text-center"><div class="progress" style="height: 20px;"><div class="progress-bar bg-success" role="progressbar"
style="width: {{ driver.on_time_pct }}%;"
aria-valuenow="{{ driver.on_time_pct }}" aria-valuemin="0" aria-valuemax="100">
{{ driver.on_time_pct }}%
</div></div></td></tr>
{% endfor %}
</tbody></table></div></div></div></div></div>
{% endblock %}
{% extends "base.html" %}

{% block title %}Equipment Reports Export - TRAXORA{% endblock %}

{% block content %}
<div class="container py-4"><div class="row mb-4"><div class="col-12"><div class="section-header"><h2><i class="bi bi-file-earmark-spreadsheet me-2"></i>Equipment Reports Export</h2><div class="section-actions"><a href="{{ url_for('index') }}" class="btn btn-outline-secondary"><i class="bi bi-house me-1"></i> Dashboard
</a></div></div></div></div><div class="row"><div class="col-md-6 mb-4"><div class="card shadow h-100"><div class="card-header bg-primary text-white"><h5 class="mb-0"><i class="bi bi-download me-2"></i>Generate Equipment Reports</h5></div><div class="card-body"><form action="{{ url_for('export_reports.generate_export') }}" method="post"><div class="mb-3"><label for="organization_id" class="form-label">Organization</label><select class="form-select" id="organization_id" name="organization_id"><option value="all">All Organizations</option>
{% for org in organizations %}
<option value="{{ org.id }}">{{ org.name }}</option>
{% endfor %}
</select></div><div class="mb-3"><label for="region" class="form-label">Region</label><select class="form-select" id="region" name="region"><option value="all">All Regions</option><option value="DFW">DFW</option><option value="Houston">Houston</option><option value="West Texas">West Texas</option></select></div><div class="mb-3"><label for="status" class="form-label">Asset Status</label><select class="form-select" id="status" name="status"><option value="all">All Statuses</option><option value="Active">Active</option><option value="Inactive">Inactive</option><option value="Maintenance">Maintenance</option><option value="Retired">Retired</option></select></div><div class="mb-4"><label class="form-label">Export Formats</label><div class="row"><div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" name="export_format" value="excel" id="excel_format" checked><label class="form-check-label" for="excel_format"><i class="bi bi-file-earmark-excel me-1 text-success"></i> Excel
</label></div></div><div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" name="export_format" value="csv" id="csv_format"><label class="form-check-label" for="csv_format"><i class="bi bi-file-earmark-text me-1 text-primary"></i> CSV
</label></div></div><div class="col-md-4"><div class="form-check"><input class="form-check-input" type="checkbox" name="export_format" value="json" id="json_format"><label class="form-check-label" for="json_format"><i class="bi bi-file-earmark-code me-1 text-danger"></i> JSON
</label></div></div></div></div><div class="d-grid"><button type="submit" class="btn btn-primary"><i class="bi bi-lightning-charge me-2"></i> Generate Reports
</button></div></form></div></div></div><div class="col-md-6 mb-4"><div class="card shadow h-100"><div class="card-header bg-primary text-white"><h5 class="mb-0"><i class="bi bi-clock-history me-2"></i>Recent Exports</h5></div><div class="card-body">
{% if recent_exports %}
<div class="table-responsive"><table class="table table-hover table-striped"><thead><tr><th>File Name</th><th>Format</th><th>Date</th><th>Size</th><th>Action</th></tr></thead><tbody>
{% for export in recent_exports %}
<tr><td>{{ export.name }}</td><td><span class="badge rounded-pill
{% if export.format == 'XLSX' %}bg-success{% elif export.format == 'CSV' %}bg-primary{% else %}bg-danger{% endif %}">
{{ export.format }}
</span></td><td>{{ export.date }}</td><td>{{ export.size }}</td><td><a href="{{ url_for('export_reports.download_file', filename=export.path) }}" class="btn btn-sm btn-primary"><i class="bi bi-download"></i></a></td></tr>
{% endfor %}
</tbody></table></div>
{% else %}
<div class="alert alert-info"><i class="bi bi-info-circle-fill me-2"></i><span>No exports found. Generate reports to see them here.</span></div>
{% endif %}
</div></div></div></div><div class="row mt-2"><div class="col-12"><div class="card shadow"><div class="card-header bg-info text-white"><h5 class="mb-0"><i class="bi bi-lightbulb me-2"></i>One-Click Export Features</h5></div><div class="card-body"><div class="row"><div class="col-md-4"><div class="text-center mb-3"><i class="bi bi-file-earmark-excel text-success" style="font-size: 2rem;"></i><h5 class="mt-2">Excel Export</h5><p class="text-muted">Complete spreadsheet with multiple tabs for detailed analysis.</p></div></div><div class="col-md-4"><div class="text-center mb-3"><i class="bi bi-file-earmark-text text-primary" style="font-size: 2rem;"></i><h5 class="mt-2">CSV Export</h5><p class="text-muted">Simple format for compatibility with other systems.</p></div></div><div class="col-md-4"><div class="text-center mb-3"><i class="bi bi-file-earmark-code text-danger" style="font-size: 2rem;"></i><h5 class="mt-2">JSON Export</h5><p class="text-muted">Structured data format for API integrations.</p></div></div></div><div class="mt-2"><div class="alert alert-secondary"><strong>Tip:</strong> Use multiple formats at once to quickly generate different versions of the same report data!
</div></div></div></div></div></div></div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
// Require at least one format to be selected
const formatCheckboxes = document.querySelectorAll('input[name="export_format"]');
const submitButton = document.querySelector('button[type="submit"]');

function updateSubmitButton() {
const atLeastOneChecked = Array.from(formatCheckboxes).some(cb => cb.checked);
submitButton.disabled = !atLeastOneChecked;

if (!atLeastOneChecked) {
submitButton.classList.remove('btn-primary');
submitButton.classList.add('btn-secondary');
} else {
submitButton.classList.remove('btn-secondary');
submitButton.classList.add('btn-primary');
}
}

formatCheckboxes.forEach(checkbox => {
checkbox.addEventListener('change', updateSubmitButton);
});

updateSubmitButton();
});
</script>
{% endblock %}
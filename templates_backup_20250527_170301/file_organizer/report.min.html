{% extends "layout_unified.html" %}

{% block title %}File Organization Report{% endblock %}

{% block content %}
<div class="container mt-4"><div class="row mb-4"><div class="col-12"><div class="card bg-dark text-white"><div class="card-body"><h2 class="card-title">File Organization Report</h2><p class="card-text">
Detailed report of the file organization process.
</p><a href="/file-organizer" class="btn btn-outline-primary"><i class="fas fa-arrow-left me-2"></i> Back to Organizer
</a></div></div></div></div>

{% if report %}
<div class="row mb-4"><div class="col-md-6"><div class="card bg-dark text-white"><div class="card-header"><h4>Summary</h4></div><div class="card-body"><p><strong>Total Files:</strong> {{ report.total_files }}</p><p><strong>Categories:</strong> {{ report.categories|length }}</p><p><strong>Dates Detected:</strong> {{ report.dates|length }}</p></div></div></div><div class="col-md-6"><div class="card bg-dark text-white"><div class="card-header"><h4>File Categories</h4></div><div class="card-body"><div class="table-responsive"><table class="table table-dark table-striped"><thead><tr><th>Category</th><th>Files Count</th></tr></thead><tbody>
{% for category, count in report.categories.items() %}
<tr><td>{{ category }}</td><td>{{ count }}</td></tr>
{% endfor %}
</tbody></table></div></div></div></div></div>

{% if report.dates %}
<div class="row mb-4"><div class="col-12"><div class="card bg-dark text-white"><div class="card-header"><h4>Files by Date</h4></div><div class="card-body"><div class="table-responsive"><table class="table table-dark table-striped"><thead><tr><th>Date</th><th>Files Count</th></tr></thead><tbody>
{% for date, count in report.dates.items() %}
<tr><td>{{ date }}</td><td>{{ count }}</td></tr>
{% endfor %}
</tbody></table></div></div></div></div></div>
{% endif %}

<div class="row"><div class="col-12"><div class="card bg-dark text-white"><div class="card-header"><h4>Directory Structure</h4></div><div class="card-body"><div class="directory-tree"><ul>
{% for root_dir, contents in report.organization_structure.items() recursive %}
<li>
{% if contents is none %}
<i class="fas fa-file me-2"></i> {{ root_dir }}
{% else %}
<i class="fas fa-folder me-2"></i> {{ root_dir }}
<ul>
{% for subdir, subcontents in contents.items() recursive %}
<li>
{% if subcontents is none %}
<i class="fas fa-file me-2"></i> {{ subdir }}
{% else %}
<i class="fas fa-folder me-2"></i> {{ subdir }}
<ul>
{% for subsubdir, subsubcontents in subcontents.items() recursive %}
<li>
{% if subsubcontents is none %}
<i class="fas fa-file me-2"></i> {{ subsubdir }}
{% else %}
<i class="fas fa-folder me-2"></i> {{ subsubdir }}
<ul>
{% for key, value in subsubcontents.items() %}
<li>
{% if value is none %}
<i class="fas fa-file me-2"></i> {{ key }}
{% else %}
<i class="fas fa-folder me-2"></i> {{ key }}
<span class="text-muted">(More files inside...)</span>
{% endif %}
</li>
{% endfor %}
</ul>
{% endif %}
</li>
{% endfor %}
</ul>
{% endif %}
</li>
{% endfor %}
</ul>
{% endif %}
</li>
{% endfor %}
</ul></div></div></div></div></div>
{% else %}
<div class="row"><div class="col-12"><div class="alert alert-warning"><h4 class="alert-heading">No Report Available</h4><p>No organization report is available. Please run the file organizer first.</p><hr><p class="mb-0"><a href="/file-organizer" class="btn btn-primary">Go to File Organizer</a></p></div></div></div>
{% endif %}
</div>
{% endblock %}

{% block styles %}
<style>
.directory-tree ul {
list-style-type: none;
padding-left: 20px;
}

.directory-tree > ul {
padding-left: 0;
}

.directory-tree li {
margin: 5px 0;
}

.directory-tree .fa-folder {
color: #ffc107;
}

.directory-tree .fa-file {
color: #6c757d;
}
</style>
{% endblock %}
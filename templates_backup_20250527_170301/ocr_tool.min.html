{% extends 'base.html' %}

{% block title %}OCR Document Processing - TRAXORA{% endblock %}

{% block content %}
<div class="container-fluid py-4"><div class="row mb-4 align-items-center"><div class="col-md-8"><h1 class="display-5 fw-bold"><i class="bi bi-file-earmark-text me-2"></i>OCR Document Processing</h1><p class="text-muted lead">Extract text from documents and images using optical character recognition</p></div><div class="col-md-4 text-end"><a href="{{ url_for('index') }}" class="btn btn-outline-secondary"><i class="bi bi-house me-2"></i> Dashboard
</a></div></div><div class="row"><div class="col-md-6 mb-4"><div class="card shadow h-100"><div class="card-header bg-primary text-white"><div class="d-flex justify-content-between align-items-center"><h4 class="mb-0"><i class="bi bi-upload me-2"></i>Upload Document</h4><span class="badge bg-light text-primary">Step 1</span></div></div><div class="card-body"><form method="POST" enctype="multipart/form-data" id="ocr-form"><div class="mb-4"><div class="d-flex mb-3"><div class="text-center me-3"><i class="bi bi-file-earmark fs-1 text-muted"></i></div><div><label for="document" class="form-label fw-bold">Select a document</label><input type="file" class="form-control" id="document" name="document" accept=".pdf,.jpg,.jpeg,.png"><div class="form-text">Supported formats: PDF, JPG, PNG</div></div></div><div class="alert alert-secondary mt-3"><div class="d-flex"><i class="bi bi-lightbulb me-2 fs-4"></i><div><p class="mb-1 fw-bold">Tips for best results:</p><ul class="mb-0"><li>Use high-resolution scans for better accuracy</li><li>Ensure documents are properly aligned</li><li>For multi-page PDFs, all pages will be processed</li></ul></div></div></div></div><div class="d-grid gap-2"><button type="submit" class="btn btn-primary btn-lg" id="process-btn"><i class="bi bi-magic me-2"></i> Process Document
</button></div><div class="mt-3 d-none" id="processing-indicator"><div class="card bg-light border-0"><div class="card-body"><div class="d-flex align-items-center mb-2"><div class="spinner-border text-primary me-3" role="status"><span class="visually-hidden">Processing...</span></div><div><h5 class="mb-0">Processing document</h5><p class="text-muted mb-0">This may take a minute depending on file size...</p></div></div><div class="progress mt-2"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 100%"></div></div></div></div></div></form></div></div></div>

{% if extracted_text %}
<div class="col-md-6 mb-4"><div class="card shadow h-100"><div class="card-header bg-success text-white"><div class="d-flex justify-content-between align-items-center"><h4 class="mb-0"><i class="bi bi-file-text me-2"></i>Extracted Text</h4><span class="badge bg-light text-success">Results</span></div></div><div class="card-body"><div class="d-flex justify-content-between align-items-center mb-3"><p class="mb-0"><i class="bi bi-file-earmark me-2"></i>Original file: <strong>{{ original_filename }}</strong></p><a href="{{ url_for('download_extracted_text', filename=text_filename) }}" class="btn btn-sm btn-outline-primary"><i class="bi bi-download me-1"></i> Download Text
</a></div><div class="card bg-light border-0 mb-3"><div class="card-body p-0"><div class="bg-light p-3" style="max-height: 400px; overflow-y: auto; border-radius: 0.25rem;"><pre class="mb-0">{{ extracted_text }}</pre></div></div></div><div class="alert alert-success"><div class="d-flex align-items-center"><i class="bi bi-check-circle-fill me-2 fs-4"></i><div><p class="mb-0 fw-bold">Text extraction complete!</p><p class="mb-0 small">You can now copy this text or download it as a file.</p></div></div></div></div></div></div>
{% else %}
<div class="col-md-6 mb-4"><div class="card shadow h-100"><div class="card-header bg-info text-white"><div class="d-flex justify-content-between align-items-center"><h4 class="mb-0"><i class="bi bi-info-circle me-2"></i>About OCR Processing</h4><span class="badge bg-light text-info">Info</span></div></div><div class="card-body"><div class="text-center mb-4"><i class="bi bi-file-earmark-text display-1 text-muted"></i></div><h5 class="fw-bold">What is OCR?</h5><p>
Optical Character Recognition (OCR) is a technology that converts different types of documents,
such as scanned paper documents, PDF files, or images into editable and searchable data.
</p><h5 class="fw-bold mt-4">Common Use Cases:</h5><ul><li>Extract text from scanned invoices and receipts</li><li>Digitize printed documents for easier searching</li><li>Convert image-based PDF files to text</li><li>Extract data from forms and reports</li></ul><div class="alert alert-info mt-4"><div class="d-flex"><i class="bi bi-lightbulb me-2 fs-4"></i><p class="mb-0">
Upload a document on the left to begin processing. The extracted text will appear
here once complete.
</p></div></div></div></div></div>
{% endif %}
</div></div>

{% endblock %}

{% block scripts %}
<script>
document.getElementById('ocr-form').addEventListener('submit', function() {
// Show processing indicator
document.getElementById('processing-indicator').classList.remove('d-none');
// Disable the button
document.getElementById('process-btn').disabled = true;
// Change button text
document.getElementById('process-btn').innerHTML = '<i class="bi bi-hourglass-split me-2"></i> Processing...';
});

// Highlight active navigation
document.addEventListener('DOMContentLoaded', function() {
const navLinks = document.querySelectorAll('.navbar-nav .nav-link');
navLinks.forEach(link => {
if (link.getAttribute('href') === '/ocr_tool') {
link.classList.add('active');
}
});
});
</script>
{% endblock %}